<?xml version="1.0"?>
<launch>
    <arg name="gps_imu" default="true"/>
    <arg name="wheel_gps_imu" default="false"/>

    
    <include file="$(find soma_bringup)/launch/sensor/new_wheel_odometry.launch" />
	<include file="$(find soma_bringup)/launch/gps_to_odom.launch" />
    <include file="$(find soma_samples)/launch/hdl.launch" />

    <group if="$(arg gps_imu)">
        <node name="ekf_gps_imu" pkg="robot_localization" type="ekf_localization_node" clear_params="true" output="screen">
            <!-- load yaml file -->
            <rosparam command="load" file="$(find soma_samples)/launch/config/ekf_final/ekf_gps_imu.yaml" />
            <!-- input -->
            <remap from="odom0" to="/gps_relative_odom" />
            <remap from="imu_data" to="/imu/data" />
            <!-- output -->
            <remap from="/odometry/filtered" to="/ekf/gps_imu_odom" />
        </node>
    </group>

    <group if="$(arg wheel_gps_imu)">
        <node name="ekf_wheel_gps_imu" pkg="robot_localization" type="ekf_localization_node" clear_params="true" output="screen">
            <!-- load yaml file -->
            <rosparam command="load" file="$(find soma_samples)/launch/config/ekf_final/ekf_wheel_gps_imu.yaml" />
            <!-- input -->
            <remap from="odom0" to="/soma/wheel_odom" />
            <remap from="odom1" to="/gps_relative_odom" />
            <remap from="imu_data" to="/imu/data" />
            <!-- output -->
            <remap from="/odometry/filtered" to="/ekf/wheel_gps_imu_odom" />
        </node>
    </group>

</launch>
